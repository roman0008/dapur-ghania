<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dapur Ghania - Premium Homemade Catering</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;400;600;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .glass-effect { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-[#fdfaf7] text-slate-900 selection:bg-orange-100 pb-32">

    <!-- Header -->
    <header class="glass-effect sticky top-0 z-40 border-b border-orange-50">
        <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-black text-[#3E2723] tracking-tighter uppercase">Dapur <span class="text-orange-600">Ghania</span></h1>
                <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Premium Homemade Catering</p>
            </div>
            <div id="user-section" class="flex items-center gap-4">
                <button onclick="toggleAuthModal()" class="flex items-center gap-2 text-xs font-bold text-[#3E2723] bg-[#efebe9] px-5 py-2.5 rounded-full hover:bg-[#e0d9d5] transition-all active:scale-95">
                    <i data-lucide="log-in" class="w-4 h-4"></i> Login Member
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-4 md:p-8 space-y-16">
        <!-- Hero Banner -->
        <section class="bg-[#3E2723] rounded-[2.5rem] p-8 md:p-16 text-white relative overflow-hidden shadow-2xl">
            <div class="relative z-10 max-w-xl">
                <div class="inline-flex items-center gap-2 bg-orange-600 text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-widest mb-6">
                    <i data-lucide="check-circle-2" class="w-3 h-3"></i> Terverifikasi Halal
                </div>
                <h2 class="text-4xl md:text-6xl font-black mb-6 leading-tight">Catering Premium Untuk Momen Spesial.</h2>
                <p class="text-orange-100/80 text-lg mb-8 font-medium leading-relaxed">Nikmati hidangan buatan rumah dengan bahan pilihan dan standar rasa bintang lima.</p>
                <button class="bg-white text-[#3E2723] px-8 py-4 rounded-2xl font-black hover:bg-orange-50 transition-colors shadow-lg">
                    Lihat Menu Spesial
                </button>
            </div>
            <div class="absolute -bottom-20 -right-20 w-96 h-96 bg-orange-600/20 rounded-full blur-[100px]"></div>
        </section>

        <!-- Menu Section -->
        <div id="product-container" class="space-y-16">
            <!-- Produk akan dimuat via JavaScript -->
        </div>
    </main>

    <!-- Floating Cart Bar -->
    <div id="cart-bar" class="fixed bottom-8 left-0 right-0 px-6 pointer-events-none z-50 hidden">
        <div onclick="toggleCart()" class="max-w-lg mx-auto bg-[#3E2723] text-white p-5 rounded-[2rem] flex justify-between items-center shadow-2xl cursor-pointer pointer-events-auto hover:scale-[1.02] transition-all ring-4 ring-white/10 active:scale-95">
            <div class="flex items-center gap-5">
                <div class="bg-orange-600 p-4 rounded-2xl relative">
                    <i data-lucide="shopping-bag"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-white text-[#3E2723] text-[10px] w-6 h-6 flex items-center justify-center rounded-full font-black border-2 border-orange-600">0</span>
                </div>
                <div>
                    <p class="text-[10px] font-black text-orange-200 uppercase tracking-widest">Total Pesanan</p>
                    <p id="total-price-bar" class="text-lg font-black leading-none">Rp 0</p>
                </div>
            </div>
            <div class="bg-white/10 px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest border border-white/10">Lihat Detail</div>
        </div>
    </div>

    <!-- Cart Drawer -->
    <div id="cart-drawer" class="fixed inset-0 bg-[#3E2723]/60 backdrop-blur-sm z-[100] hidden items-end sm:items-center justify-center p-0 sm:p-4">
        <div class="bg-white w-full max-w-lg rounded-t-[3rem] sm:rounded-[3rem] max-h-[90vh] flex flex-col shadow-2xl">
            <div class="p-8 pb-4 flex justify-between items-center border-b border-orange-50">
                <h3 class="text-2xl font-black text-[#3E2723] uppercase tracking-tighter">Box Pesanan</h3>
                <button onclick="toggleCart()" class="p-2 bg-slate-50 rounded-full text-slate-400 hover:rotate-90 transition-transform">
                    <i data-lucide="x"></i>
                </button>
            </div>
            <div id="cart-items-list" class="flex-grow overflow-y-auto p-8 space-y-6">
                <!-- Items dimuat di sini -->
            </div>
            <div id="cart-summary" class="p-8 bg-[#3E2723] rounded-t-[3rem] text-white">
                <div class="space-y-4 mb-8">
                    <div class="flex justify-between text-[10px] font-black text-orange-200/50 uppercase">
                        <span>Subtotal</span>
                        <span id="subtotal-val">Rp 0</span>
                    </div>
                    <div id="promo-section" class="hidden bg-white/5 p-4 rounded-2xl border border-white/10 text-[10px] font-bold text-emerald-400">
                        <!-- Diskon dimuat di sini -->
                    </div>
                    <div class="flex justify-between items-center pt-4 border-t border-white/10">
                        <span class="text-xs font-black uppercase tracking-widest">Total Bayar</span>
                        <span id="final-total-val" class="text-3xl font-black text-orange-500">Rp 0</span>
                    </div>
                </div>
                <button onclick="checkout()" class="w-full py-5 bg-orange-600 text-white rounded-2xl font-black text-sm uppercase tracking-widest hover:bg-white hover:text-orange-600 transition-all">
                    Pesan via WhatsApp
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="fixed top-10 left-1/2 -translate-x-1/2 px-8 py-4 bg-[#3E2723] text-white rounded-full font-black text-[10px] uppercase tracking-widest shadow-2xl z-[200] hidden animate-bounce flex items-center gap-3">
        <i data-lucide="check-circle-2" class="text-emerald-400"></i>
        <span id="toast-msg">Pesan Terkirim</span>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";

        // Konfigurasi Firebase dari Environment
        const firebaseConfig = JSON.parse(window.__firebase_config || '{}');
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Data Produk
        const products = {
            simple: [
                { id: 1, name: "Onde Onde Premium", price: 80000, img: "https://i.pinimg.com/736x/1c/ad/0f/1cad0f0468d08ec7360bcdbb1b091530.jpg" },
                { id: 2, name: "Pastel Gurih (10 Pcs)", price: 90000, img: "https://i.pinimg.com/736x/3b/e3/29/3be329a4dbee5bb31b925b09b6e6b257.jpg" },
                { id: 3, name: "Sosis Solo Box", price: 75000, img: "https://i.pinimg.com/736x/e6/52/78/e65278783688669e4695027581b2a9d6.jpg" }
            ],
            exclusive: [
                { id: 10, name: "Pudding Art Special", price: 175000, img: "https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400" },
                { id: 11, name: "Exclusive Gift Box", price: 250000, img: "https://images.unsplash.com/photo-1555507036-ab1f4038808a?w=400" },
                { id: 12, name: "Hampers Hari Raya", price: 350000, img: "https://images.unsplash.com/photo-1544476073-42ca5185966d?w=400" }
            ]
        };

        let cart = [];

        // Inisialisasi Auth (Otomatis Anonim jika login belum diaktifkan)
        signInAnonymously(auth).catch(err => console.error("Auth Error:", err));
        
        onAuthStateChanged(auth, (user) => {
            const userSection = document.getElementById('user-section');
            if (user && !user.isAnonymous) {
                userSection.innerHTML = `
                    <div class="flex items-center gap-3">
                        <div class="text-right">
                            <p class="text-[9px] font-bold text-orange-600 uppercase">Premium Member</p>
                            <p class="text-sm font-black text-[#3E2723]">${user.email?.split('@')[0] || 'Member'}</p>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-[#3E2723] border-2 border-orange-200 flex items-center justify-center text-white font-black">
                            ${(user.email || 'M').charAt(0).toUpperCase()}
                        </div>
                    </div>
                `;
            }
        });

        // Render Produk
        function renderProducts() {
            const container = document.getElementById('product-container');
            container.innerHTML = '';
            
            Object.keys(products).forEach(cat => {
                const section = document.createElement('section');
                section.innerHTML = `
                    <div class="mb-10">
                        <h3 class="font-black text-3xl text-[#3E2723] uppercase tracking-tighter">${cat === 'simple' ? 'Menu Simple Box' : 'Exclusive Collection'}</h3>
                        <div class="h-1.5 w-16 bg-orange-600 rounded-full mt-2"></div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">
                        ${products[cat].map(p => `
                            <div class="bg-white rounded-[2.5rem] overflow-hidden border border-orange-50 shadow-sm hover:shadow-2xl transition-all duration-500 group flex flex-col hover:-translate-y-2">
                                <div class="aspect-[4/3] overflow-hidden relative">
                                    <img src="${p.img}" alt="${p.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
                                    <div class="absolute bottom-4 left-4 bg-white/90 backdrop-blur-md px-4 py-2 rounded-2xl shadow-lg font-black text-sm">
                                        Rp ${p.price.toLocaleString()}
                                    </div>
                                </div>
                                <div class="p-8 flex flex-col flex-grow">
                                    <h4 class="font-black text-slate-800 mb-2 uppercase text-base">${p.name}</h4>
                                    <p class="text-xs text-slate-400 mb-8 flex-grow">Resep premium warisan keluarga dengan rasa autentik.</p>
                                    <button onclick="addToCart(${p.id}, '${p.name}', ${p.price}, '${p.img}')" class="w-full py-4 bg-[#fdf2f0] text-orange-700 rounded-2xl font-black flex items-center justify-center gap-2 hover:bg-[#3E2723] hover:text-white transition-all active:scale-95">
                                        <i data-lucide="plus" class="w-5 h-5"></i> TAMBAH
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(section);
            });
            lucide.createIcons();
        }

        // Global functions for HTML onclick
        window.addToCart = (id, name, price, img) => {
            const existing = cart.find(i => i.id === id);
            if (existing) {
                existing.qty++;
            } else {
                cart.push({ id, name, price, img, qty: 1 });
            }
            updateUI();
            showToast(`âœ“ ${name} ditambahkan`);
        };

        window.updateQty = (id, delta) => {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.qty += delta;
                if (item.qty <= 0) cart = cart.filter(i => i.id !== id);
            }
            updateUI();
        };

        function updateUI() {
            const totalQty = cart.reduce((s, i) => s + i.qty, 0);
            const subtotal = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            const discOngkir = subtotal >= 1000000 ? 50000 : 0;
            const finalTotal = subtotal - discOngkir;

            // Update Bar
            const bar = document.getElementById('cart-bar');
            if (totalQty > 0) bar.classList.remove('hidden'); else bar.classList.add('hidden');
            
            document.getElementById('cart-count').innerText = totalQty;
            document.getElementById('total-price-bar').innerText = `Rp ${finalTotal.toLocaleString()}`;

            // Update Drawer
            const list = document.getElementById('cart-items-list');
            if (cart.length === 0) {
                list.innerHTML = `<div class="text-center py-20 opacity-20"><i data-lucide="shopping-bag" class="w-20 h-20 mx-auto mb-4"></i><p class="font-black uppercase">Kosong</p></div>`;
            } else {
                list.innerHTML = cart.map(item => `
                    <div class="flex items-center gap-4 bg-slate-50 p-4 rounded-3xl border border-orange-50">
                        <img src="${item.img}" class="w-16 h-16 rounded-xl object-cover">
                        <div class="flex-grow">
                            <p class="text-xs font-black uppercase text-[#3E2723]">${item.name}</p>
                            <p class="text-[10px] font-bold text-orange-600">Rp ${item.price.toLocaleString()}</p>
                        </div>
                        <div class="flex items-center gap-3 bg-white px-3 py-2 rounded-xl shadow-sm">
                            <button onclick="updateQty(${item.id}, -1)" class="text-orange-600 hover:scale-110"><i data-lucide="minus" class="w-4 h-4"></i></button>
                            <span class="font-black text-sm">${item.qty}</span>
                            <button onclick="updateQty(${item.id}, 1)" class="text-orange-600 hover:scale-110"><i data-lucide="plus" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                `).join('');
            }

            document.getElementById('subtotal-val').innerText = `Rp ${subtotal.toLocaleString()}`;
            document.getElementById('final-total-val').innerText = `Rp ${finalTotal.toLocaleString()}`;
            
            const promo = document.getElementById('promo-section');
            if (discOngkir > 0) {
                promo.classList.remove('hidden');
                promo.innerText = `POTONGAN ONGKIR PREMIUM: - Rp ${discOngkir.toLocaleString()}`;
            } else {
                promo.classList.add('hidden');
            }

            lucide.createIcons();
        }

        window.toggleCart = () => {
            const drawer = document.getElementById('cart-drawer');
            drawer.classList.toggle('hidden');
            drawer.classList.toggle('flex');
        };

        window.showToast = (msg) => {
            const toast = document.getElementById('toast');
            document.getElementById('toast-msg').innerText = msg;
            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.add('hidden'), 3000);
        };

        window.checkout = () => {
            const text = encodeURIComponent(`Halo Dapur Ghania, saya ingin pesan:\n${cart.map(i => `- ${i.name} (${i.qty})`).join('\n')}\nTotal: ${document.getElementById('final-total-val').innerText}`);
            window.open(`https://wa.me/628123456789?text=${text}`, '_blank');
        };

        // Run On Load
        window.onload = () => {
            renderProducts();
            lucide.createIcons();
        };

    </script>
</body>
</html>
